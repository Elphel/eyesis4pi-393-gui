<html>
<head>
    <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>

    <script>

	var baseWidth = 2592;
	var baseHeight = 1948;

	var baseWidth = 200;
	var baseHeight = 150;

        var cams = [
          {"ip":"192.168.0.161","port":2326,"channel":3,"master":0,"logger":0},
          {"ip":"192.168.0.161","port":2325,"channel":2,"master":0,"logger":0},
          {"ip":"192.168.0.161","port":2323,"channel":0,"master":0,"logger":1},
          {"ip":"192.168.0.161","port":2324,"channel":1,"master":0,"logger":0},
          {"ip":"192.168.0.162","port":2326,"channel":3,"master":0,"logger":0},
          {"ip":"192.168.0.162","port":2325,"channel":2,"master":0,"logger":0},
          {"ip":"192.168.0.162","port":2323,"channel":0,"master":0,"logger":0},
          {"ip":"192.168.0.162","port":2324,"channel":1,"master":0,"logger":0}
        ];

	var cnv;
	var cContext;

	function init(){
	    cnv = document.getElementById('canvas');
	    cContext = cnv.getContext('2d');
	    refresh_images();
	}

        function refresh_images(){
          var pic = {};
          
          cnv.setAttribute('width',baseHeight*8);cnv.setAttribute('height',baseWidth*3);

          for(var i=0;i<cams.length;i++){
            pic[i] = new Image();
            pic[i].src = "http://"+cams[i].ip+":"+cams[i].port+"/bimg?"+Date.now();
            pic[i].index = i;
            pic[i].onload = function(){
              draw_an_image(this);
            };
          }
        }

        function draw_an_image(img){
          var w = baseWidth;
          var h = baseHeight;
          var W = 2592;
          var H = 1944;

          cContext.rotate(90*Math.PI/180);
          
          if (img.index%2==0) {
            cContext.drawImage(img, 0,0*H,W,H, 0*w,-1*h*(img.index+1),w,h);
            cContext.drawImage(img, 0,1*H,W,H, 1*w,-1*h*(img.index+1),w,h);
            cContext.scale(-1,1);
            cContext.drawImage(img, 0,2*H,W,H, -3*w, -1*h*(img.index+1), w, h);
            cContext.scale(-1,1);
          }else{
            cContext.scale(1,-1); //mirror is needed
            cContext.drawImage(img, 0,0*H,W,H, 0*w,img.index*h,w,h);
            cContext.drawImage(img, 0,1*H,W,H, 1*w,img.index*h,w,h);
            cContext.scale(-1,1);
            cContext.drawImage(img, 0,2*H,W,H, -3*w,h*(img.index),w,h);
            cContext.scale(-1,-1);
          }
          
          cContext.rotate(-90*Math.PI/180);
        }

    </script>

</head>
<body onload="init()">
    <canvas id="canvas" style="background:rgba(100,200,100,0.5);"></canvas>
</body>
</html>